!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Sheet2API=e()}(this,(function(){"use strict";const t="https://sheet2api.com/v1/",e=function(t,e){return n(t,e)},n=function(e,n){let o="";return s(e,t)?o+=e:o+=t+e,n&&void 0!==n.sheet&&(o+=n.sheet+"/",delete n.sheet),n&&void 0!==n.query&&(o+="?"+function(t){const e=[];for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")}(n.query)),o},s=function(t,e,n){return n=n||0,t.indexOf(e,n)===n};function o(t,n){return new Promise((function(s,o){const u=new XMLHttpRequest,r=e(t,n);u.open("GET",r,!0),u.onload=function(){this.status>=200&&this.status<300?s(JSON.parse(u.responseText)):o({status:this.status,statusText:u.statusText})},u.setRequestHeader("Content-Type","application/json"),u.onerror=function(t){o(t)},u.send()}))}function u(t,n,s){return new Promise((function(o,u){const r=new XMLHttpRequest,i=e(t,n);r.open("POST",i,!0),r.onload=function(){this.status>=200&&this.status<300?o(JSON.parse(r.responseText)):u({status:this.status,statusText:r.statusText})},r.setRequestHeader("Content-Type","application/json; charset=UTF-8"),r.onerror=function(t){u(t)},r.send(JSON.stringify(s))}))}return{read:function(){return o.apply(null,arguments)},write:function(){return u.apply(null,arguments)},version:"1.0"}}));